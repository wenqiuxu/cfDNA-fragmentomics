#####3. align pair end#########################################
bwa aln -t 8 /home/xuwenqiu/reference/GRCh38/GRCh38_bwa/GCA_000001405.15_GRCh38_no_alt_plus_hs38d1_analysis_set.fna /home/xuwenqiu/cfDNA/saturation/jiangmen/cleandata/EPE/20P6252302_1/20P6252302_1.clean.read1.fq.gz > /home/xuwenqiu/cfDNA/saturation/jiangmen/align_result/EPE/20P6252302_1/20P6252302_1.1.sai
bwa aln -t 8 /home/xuwenqiu/reference/GRCh38/GRCh38_bwa/GCA_000001405.15_GRCh38_no_alt_plus_hs38d1_analysis_set.fna /home/xuwenqiu/cfDNA/saturation/jiangmen/cleandata/EPE/20P6252302_1/20P6252302_1.clean.read2.fq.gz > /home/xuwenqiu/cfDNA/saturation/jiangmen/align_result/EPE/20P6252302_1/20P6252302_1.2.sai
bwa sampe -n 1 /home/xuwenqiu/reference/GRCh38/GRCh38_bwa/GCA_000001405.15_GRCh38_no_alt_plus_hs38d1_analysis_set.fna /home/xuwenqiu/cfDNA/saturation/jiangmen/align_result/EPE/20P6252302_1/20P6252302_1.1.sai /home/xuwenqiu/cfDNA/saturation/jiangmen/align_result/EPE/20P6252302_1/20P6252302_1.2.sai /home/xuwenqiu/cfDNA/saturation/jiangmen/cleandata/EPE/20P6252302_1/20P6252302_1.clean.read1.fq.gz /home/xuwenqiu/cfDNA/saturation/jiangmen/cleandata/EPE/20P6252302_1/20P6252302_1.clean.read2.fq.gz > /home/xuwenqiu/cfDNA/saturation/jiangmen/align_result/EPE/20P6252302_1/20P6252302_1.sam
rm /home/xuwenqiu/cfDNA/saturation/jiangmen/align_result/EPE/20P6252302_1/20P6252302_1.1.sai
rm /home/xuwenqiu/cfDNA/saturation/jiangmen/align_result/EPE/20P6252302_1/20P6252302_1.2.sai
less /home/xuwenqiu/cfDNA/saturation/jiangmen/align_result/EPE/20P6252302_1/20P6252302_1.sam|awk '$1!~/^@/ && $2!=4'|wc -l|awk -v name_20P6252302_1="20P6252302_1" '{print name_20P6252302_1"\tmapped_reads\t"$1}' > /home/xuwenqiu/cfDNA/saturation/jiangmen/align_result/EPE/20P6252302_1/statistics.txt

####4. extract unique mapping####################################
cat /home/xuwenqiu/cfDNA/saturation/jiangmen/align_result/EPE/20P6252302_1/20P6252302_1.sam|awk -F "\t" '{if($1~/^@/) print $0; else if(($3=="chr1" || $3=="chr2" || $3=="chr3" || $3=="chr4" || $3=="chr5" || $3=="chr6" || $3=="chr7" || $3=="chr8" || $3=="chr9" || $3=="chr10" || $3=="chr11" || $3=="chr12" || $3=="chr13" || $3=="chr14" || $3=="chr15" || $3=="chr16" || $3=="chr17" || $3=="chr18" || $3=="chr19" || $3=="chr20" || $3=="chr21" || $3=="chr22") && $12~/XT:A:U/) print $0}' > /home/xuwenqiu/cfDNA/saturation/jiangmen/align_result/EPE/20P6252302_1/20P6252302_1.uniq.sam
rm /home/xuwenqiu/cfDNA/saturation/jiangmen/align_result/EPE/20P6252302_1/20P6252302_1.sam
less /home/xuwenqiu/cfDNA/saturation/jiangmen/align_result/EPE/20P6252302_1/20P6252302_1.uniq.sam|awk '$1!~/^@/ && $2!=4'|wc -l|awk -v name_20P6252302_1="20P6252302_1" '{print name_20P6252302_1"\tuniq_mapped_reads\t"$1}' >> /home/xuwenqiu/cfDNA/saturation/jiangmen/align_result/EPE/20P6252302_1/statistics.txt
samtools view -@ 8 -b -S -o /home/xuwenqiu/cfDNA/saturation/jiangmen/align_result/EPE/20P6252302_1/20P6252302_1.uniq.bam /home/xuwenqiu/cfDNA/saturation/jiangmen/align_result/EPE/20P6252302_1/20P6252302_1.uniq.sam
rm /home/xuwenqiu/cfDNA/saturation/jiangmen/align_result/EPE/20P6252302_1/20P6252302_1.uniq.sam
